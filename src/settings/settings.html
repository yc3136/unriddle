<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>unriddle Settings</title>
  <link rel="stylesheet" href="settings.css">
</head>
<body>
  <div class="settings-container">
    <header class="settings-header">
      <img src="../../icons/unriddle-128.png" alt="unriddle logo" class="logo" />
      <h1>unriddle Settings</h1>
    </header>
    
    <main class="settings-content">
      <section class="setting-section">
        <h2>Language</h2>
        <p class="setting-description">Choose the language for unriddled translations</p>
        <div class="language-info">
          <p class="language-explanation">
            <strong>How it works:</strong> When you select text and use "unriddle", 
            the AI will explain the content in the language you choose here. 
            This affects all future unriddle requests until you change this setting.
          </p>
        </div>
        <div class="language-selector">
          <select id="language-select" class="language-dropdown">
            <!-- Language options will be populated dynamically by JavaScript -->
          </select>
        </div>
      </section>

      <section class="setting-section">
        <h2>LLM Configuration</h2>
        <p class="setting-description">Configure your Gemini API key and context window size for explanations</p>
        <div class="llm-info">
          <div class="api-key-info">
            <div class="api-key-status" id="api-key-status">
              <span class="status-text">No API key set - using extension's shared key</span>
            </div>
            <h3 class="config-subheading">API Key</h3>
            <div class="api-key-instructions">
              <h4>How to get your API key:</h4>
              <ol>
                <li>Go to <a href="https://makersuite.google.com/app/apikey" target="_blank" rel="noopener">Google AI Studio</a></li>
                <li>Sign in with your Google account</li>
                <li>Click "Create API Key"</li>
                <li>Copy the generated key and paste it below</li>
              </ol>
              <p class="api-key-note">
                <strong>Note:</strong> Your API key is stored locally in your browser and is never sent to our servers.
              </p>
            </div>
            <div class="api-key-input">
              <input 
                type="password" 
                id="api-key-input" 
                class="api-key-field" 
                placeholder="Enter your Gemini API key (optional)"
                autocomplete="off"
              />
              <button id="toggle-api-key" class="toggle-api-key-btn" type="button" aria-label="Show/hide API key">
                üëÅ
              </button>
            </div>
          </div>

          <div class="context-window-info">
            <h3 class="config-subheading">Context Window Size (number of words)</h3>
            <div class="context-window-instructions settings-description-unified" style="margin-bottom: 12px;">
              <ul style="margin: 0; padding-left: 20px;">
                <li>Leave empty for <strong>full page</strong> context.</li>
                <li>Enter <strong>0</strong> for no extra context (just your selection).</li>
                <li>Higher values provide more background but may be slower and use more API quota.</li>
                <li>Default is <strong>40</strong> words.</li>
              </ul>
            </div>
            <input 
              type="number" 
              id="context-window-input" 
              class="context-window-field" 
              min="0" 
              placeholder="40 (default)" 
              autocomplete="off"
            />
          </div>

          <div class="additional-llm-instructions-info">
            <h3 class="config-subheading">Additional LLM Instructions</h3>
            <div class="additional-llm-instructions-description" style="font-size: 0.92em; margin-top: 4px;">
              This text will be added to the LLM's instructions, together with the default prompt. Use it to customize the style, audience, or other preferences for the output.
            </div>
            <textarea 
              id="custom-prompt-input" 
              class="additional-llm-instructions-field" 
              rows="3" 
              placeholder="E.g. Explain as if to a 5 year old, use a friendly tone, etc."
              autocomplete="off"
              style="width: 100%; margin-top: 6px; resize: vertical; min-height: 48px;"
            ></textarea>
          </div>
        </div>
      </section>

      <section class="setting-section">
        <h2>Font Configuration</h2>
        <p class="setting-description">Configure the font used for LLM responses in the in-page popup.</p>
        <div class="font-config-info">
          <label style="display: flex; align-items: center; gap: 8px;">
            <input type="radio" name="font-mode" id="font-mode-dynamic" checked />
            <span><strong>Use dynamic font</strong> (match the font of your selected text)</span>
          </label>
          <div class="font-dynamic-explanation additional-llm-instructions-description" style="margin: 8px 0 0 28px;">
            The popup will use the same font family and size as the text you selected. This is the default and works best for most sites.
          </div>
          <label style="display: flex; align-items: center; gap: 8px; margin-top: 16px;">
            <input type="radio" name="font-mode" id="font-mode-custom" />
            <span><strong>Use custom font</strong></span>
          </label>
        </div>
        <div id="font-custom-controls" style="margin-top: 18px; display: none;">
          <label for="font-family-select" class="config-subheading" style="margin-bottom: 4px;">Font Family</label>
          <select id="font-family-select" class="font-family-dropdown">
            <option value="Arial">Arial</option>
            <option value="Helvetica">Helvetica</option>
            <option value="Times New Roman">Times New Roman</option>
            <option value="Georgia">Georgia</option>
            <option value="Verdana">Verdana</option>
            <option value="Tahoma">Tahoma</option>
            <option value="Trebuchet MS">Trebuchet MS</option>
            <option value="Courier New">Courier New</option>
            <option value="Lucida Console">Lucida Console</option>
            <option value="Segoe UI">Segoe UI</option>
            <option value="Roboto">Roboto</option>
            <option value="Inter">Inter</option>
            <option value="Comic Sans MS">Comic Sans MS</option>
            <option value="Palatino Linotype">Palatino Linotype</option>
            <option value="Garamond">Garamond</option>
            <option value="Impact">Impact</option>
            <option value="Consolas">Consolas</option>
            <option value="Monaco">Monaco</option>
            <option value="Calibri">Calibri</option>
            <option value="Cambria">Cambria</option>
            <option value="Franklin Gothic Medium">Franklin Gothic Medium</option>
            <option value="Gill Sans">Gill Sans</option>
            <option value="Optima">Optima</option>
          </select>
          <label for="font-size-input" style="display: block; margin-top: 12px;">Font Size (px)</label>
          <input type="number" id="font-size-input" class="font-size-field" min="10" max="48" step="1" value="16" style="width: 80px; margin-top: 2px;" />
          <div style="margin-top: 16px;">
            <span class="font-example-label" style="font-size: 0.95em; color: #888;">Example:</span>
            <div id="font-example-text" style="margin-top: 6px; padding: 10px 16px; border-radius: 8px; background: #f8f9fa; border: 1px solid #eee; display: inline-block; min-width: 120px;">The quick brown fox jumps over the lazy dog.</div>
          </div>
        </div>
      </section>

      <section class="setting-section">
        <h2>About</h2>
        <p class="setting-description">
          unriddle helps you understand complex text by explaining it in simple terms. 
                      Right-click any selected text and choose "unriddle" to get started.
        </p>
        <div class="version-info">
          <span>Version 1.2.0</span>
        </div>
      </section>
    </main>

    <footer class="settings-footer">
      <button id="save-settings" class="save-button">Save Settings</button>
      <div id="save-status" class="save-status"></div>
    </footer>
  </div>
  
  <script type="module" src="settings.js"></script>
</body>
</html> 