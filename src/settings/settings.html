<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>unriddle Settings</title>
  <link rel="stylesheet" href="settings.css">
  <!-- Removed Material Web and Google Fonts links -->
</head>
<body>
  <div class="settings-container">
    <header class="settings-header">
      <img src="../../icons/unriddle-128.png" alt="unriddle logo" class="logo" />
      <h1>unriddle Settings</h1>
    </header>
    
    <main class="settings-content">
      <section class="setting-section">
        <h2>Language</h2>
        <p class="setting-description">Choose the language for unriddled translations</p>
        <div class="language-info">
          <p class="language-explanation">
            <strong>How it works:</strong> When you select text and use "unriddle", 
            the AI will explain the content in the language you choose here. 
            This affects all future unriddle requests until you change this setting.
          </p>
          <p class="setting-caveat caveat-note">
            <strong>Note:</strong> Choosing a language other than English may increase response time, as the LLM may take longer to process translations.
          </p>
        </div>
        <div class="language-selector">
          <select id="language-select" class="language-dropdown">
            <!-- Language options will be populated dynamically by JavaScript -->
          </select>
        </div>
      </section>

      <section class="setting-section">
        <h2>LLM</h2>
        <p class="setting-description">Configure your Gemini API key and context window size for explanations</p>
        <div class="llm-info">
          <div class="api-key-info">
            <div class="api-key-status" id="api-key-status">
              <span class="status-text">No API key set - using extension's shared key</span>
            </div>
            <h3 class="config-subheading">API Key</h3>
            <div class="api-key-instructions">
              <h4>How to get your API key:</h4>
              <ol>
                <li>Go to <a href="https://makersuite.google.com/app/apikey" target="_blank" rel="noopener">Google AI Studio</a></li>
                <li>Sign in with your Google account</li>
                <li>Click "Create API Key"</li>
                <li>Copy the generated key and paste it below</li>
              </ol>
              <p class="api-key-note">
                <strong>Note:</strong> Your API key is stored locally in your browser and is never sent to our servers.
              </p>
            </div>
            <div class="api-key-input">
              <input 
                type="password" 
                id="api-key-input" 
                class="api-key-field" 
                placeholder="Enter your Gemini API key (optional)"
                autocomplete="off"
              />
              <button id="toggle-api-key" class="toggle-api-key-btn" type="button" aria-label="Show/hide API key">
                üëÅ
              </button>
              <button id="clear-api-key" class="clear-api-key-btn clear-btn-style" type="button" aria-label="Clear API Key" title="Clear API Key">
                √ó
              </button>
            </div>
          </div>

          <div class="model-selection-info" id="model-selection-anchor">
            <h3 class="config-subheading">Model Selection</h3>
            <div class="model-selection-description settings-description-unified mb-12">
              Choose which Gemini model to use for explanations. Different models offer different balances of speed, quality, and capabilities.
            </div>
            <div class="model-selector">
              <select id="model-select" class="model-dropdown">
                <!-- Model options will be populated dynamically by JavaScript -->
              </select>
            </div>
          </div>

          <div class="context-window-info">
            <h3 class="config-subheading">Context Window Size (number of words)</h3>
            <div class="context-window-instructions settings-description-unified mb-12">
              <ul class="pl-20">
                <li>Leave empty for <strong>full page</strong> context.</li>
                <li>Enter <strong>0</strong> for no extra context (just your selection).</li>
                <li>Higher values provide more background but may be slower and use more API quota.</li>
                <li>Default is <strong>40</strong> words.</li>
              </ul>
              <p class="setting-caveat caveat-note">
                <strong>Note:</strong> Increasing the context window size may increase response time, as more text is sent to the LLM for processing.
              </p>
            </div>
            <input 
              type="number" 
              id="context-window-input" 
              class="context-window-field" 
              min="0" 
              placeholder="40 (default)" 
              autocomplete="off"
            />
          </div>

          <div class="additional-llm-instructions-info">
            <h3 class="config-subheading">Additional LLM Instructions</h3>
            <div class="additional-llm-instructions-description addllm-desc">
              This text will be added to the LLM's instructions, together with the default prompt. Use it to customize the style, audience, or other preferences for the output.
              <p class="setting-caveat caveat-note">
                <strong>Note:</strong> Adding extra instructions may increase response time, especially if the instructions are long or complex.
              </p>
            </div>
            <textarea 
              id="custom-prompt-input" 
              class="additional-llm-instructions-field fullwidth-mt6-resize" 
              rows="3" 
              placeholder="E.g. Explain as if to a 5 year old, use a friendly tone, etc."
              autocomplete="off"
            ></textarea>
          </div>
        </div>
      </section>

      <section class="setting-section">
        <h2>Font</h2>
        <p class="setting-description">Configure the font used for LLM responses in the in-page popup.</p>
        <div class="font-config-info">
          <label class="flex-align-center gap-8">
            <input type="radio" name="font-mode" id="font-mode-dynamic" checked />
            <span><strong>Use dynamic font</strong> (match the font of your selected text)</span>
          </label>
          <div class="font-dynamic-explanation additional-llm-instructions-description mt8-ml28">
            The popup will use the same font family and size as the text you selected. This is the default and works best for most sites.
          </div>
          <label class="flex-align-center gap-8 mt-16">
            <input type="radio" name="font-mode" id="font-mode-custom" />
            <span><strong>Use custom font</strong></span>
          </label>
        </div>
        <div id="font-custom-controls" class="mt-18 d-none">
          <div class="font-custom-row">
            <label for="font-family-select" class="font-family-label">Font Family</label>
            <select id="font-family-select" class="font-family-dropdown">
              <option value="Arial">Arial</option>
              <option value="Helvetica">Helvetica</option>
              <option value="Times New Roman">Times New Roman</option>
              <option value="Georgia">Georgia</option>
              <option value="Verdana">Verdana</option>
              <option value="Tahoma">Tahoma</option>
              <option value="Trebuchet MS">Trebuchet MS</option>
              <option value="Courier New">Courier New</option>
              <option value="Lucida Console">Lucida Console</option>
              <option value="Segoe UI">Segoe UI</option>
              <option value="Roboto">Roboto</option>
              <option value="Inter">Inter</option>
              <option value="Comic Sans MS">Comic Sans MS</option>
              <option value="Palatino Linotype">Palatino Linotype</option>
              <option value="Garamond">Garamond</option>
              <option value="Impact">Impact</option>
              <option value="Consolas">Consolas</option>
              <option value="Monaco">Monaco</option>
              <option value="Calibri">Calibri</option>
              <option value="Cambria">Cambria</option>
              <option value="Franklin Gothic Medium">Franklin Gothic Medium</option>
              <option value="Gill Sans">Gill Sans</option>
              <option value="Optima">Optima</option>
            </select>
            <label for="font-size-input" class="mx-8 ml-24 nowrap">Font Size (px)</label>
            <input type="number" id="font-size-input" class="font-size-field w-80 mt-0" min="10" max="48" step="1" value="16" />
          </div>
          <div class="mt-16">
            <span class="font-example-label font-example">Example:</span>
            <div id="font-example-text" class="font-example-text">The quick brown fox jumps over the lazy dog.</div>
          </div>
        </div>
      </section>

      <section class="setting-section" id="developer-options-section">
        <div class="dev-options-header-row">
          <label for="dev-options-toggle">
            <input type="checkbox" id="dev-options-toggle" />
          </label>
          <h2>Developer Options</h2>
        </div>
        <div id="error-logs-section" class="d-none">
          <h3>Error Logs</h3>
          <p class="font-dynamic-explanation">Error logs are stored locally and never sent anywhere unless you choose to share them.</p>
          <div class="error-logs-btn-row">
            <button id="copy-error-logs-btn" type="button">Copy Error Logs</button>
            <button id="clear-error-logs-btn" type="button">Clear Error Logs</button>
          </div>
        </div>
      </section>

      <section class="setting-section">
        <h2>About</h2>
        <p class="setting-description">
          unriddle helps you understand complex text by explaining it in simple terms. 
                      Right-click any selected text and choose "unriddle" to get started.
        </p>
      </section>
    </main>

    <footer class="settings-footer">
      <button id="save-settings" class="save-button">Save Settings</button>
      <div id="save-status" class="save-status"></div>
    </footer>
  </div>
  
  <script type="module" src="settings.js"></script>
</body>
</html> 